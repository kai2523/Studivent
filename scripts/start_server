#!/bin/bash

echo "ğŸš€ Starte start_server Skript..."
cd /var/www/html || {
  echo "âŒ /var/www/html nicht gefunden"
  exit 1
}

echo "ğŸ“‚ Aktuelles Verzeichnis: $(pwd)"
echo "ğŸ“„ Dateien:"
ls -la

APP_NAME="backend-api"

# Check if app is already running in PM2
if pm2 list | grep -q "$APP_NAME"; then
  echo "ğŸ” Reload bestehender PM2-Prozess ($APP_NAME)..."
  pm2 reload ecosystem.config.js --only "$APP_NAME"
else
  echo "ğŸš€ Starte neue PM2-App mit ecosystem.config.js..."
  pm2 start ecosystem.config.js
fi

# Ensure process is auto-started on server reboot
pm2 save

echo "âœ… PM2-Prozess $APP_NAME lÃ¤uft."
