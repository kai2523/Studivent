#!/bin/bash

echo "ğŸš€ Starte install_dependencies Skript..."

echo "ğŸ“‚ Aktuelles Verzeichnis (vor mkdir): $(pwd)"

mkdir -p /var/www/html
echo "ğŸ“ Verzeichnis /var/www/html wurde erstellt (falls nicht vorhanden)."

cd /var/www/html || {
  echo "âŒ Fehler: /var/www/html existiert nicht oder konnte nicht betreten werden."
  exit 1
}
echo "ğŸ“‚ Neues Arbeitsverzeichnis: $(pwd)"

if ! command -v npm &> /dev/null; then
  echo "ğŸ“¦ Node.js wird installiert..."
  curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
  sudo apt install -y nodejs
else
  echo "âœ… Node.js ist bereits installiert. Version: $(npm -v)"
fi

echo "ğŸ“„ Dateien im aktuellen Verzeichnis:"
ls -la

if [ -f "package.json" ]; then
  echo "ğŸ“¦ package.json gefunden â€“ fÃ¼hre npm install aus..."
  npm install
else
  echo "âš ï¸  Keine package.json im aktuellen Verzeichnis gefunden â€“ npm install wird Ã¼bersprungen."
fi

echo "âœ… install_dependencies abgeschlossen."
